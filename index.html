<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>D√©couvrez votre Enn√©agramme</title>
    <style>
        /* --- Styles (Identiques √† la version pr√©c√©dente) --- */
        :root { /* ... couleurs et variables ... */
            --primary-color: #3B82F6; --secondary-color: #F59E0B; --background-color: #F3F4F6;
            --card-bg-color: #FFFFFF; --text-color: #1F2937; --text-muted-color: #6B7280;
            --border-color: #E5E7EB; --light-gray: #F9FAFB; --medium-gray: #D1D5DB;
            --dark-gray: #4B5563; --danger-color: #EF4444; --success-color: #10B981;
            --type1-color: #EF4444; --type2-color: #F59E0B; --type3-color: #10B981;
            --type4-color: #6366F1; --type5-color: #3B82F6; --type6-color: #6B7280;
            --type7-color: #EC4899; --type8-color: #8B5CF6; --type9-color: #84CC16;
            --font-sans: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { font-size: 16px; scroll-behavior: smooth; }
        body { font-family: var(--font-sans); line-height: 1.6; color: var(--text-color); background-color: var(--background-color); display: flex; justify-content: center; align-items: flex-start; padding: 30px 15px; min-height: 100vh; }
        #app { background-color: var(--card-bg-color); padding: 30px 35px; border-radius: 12px; box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.07), 0 4px 6px -4px rgba(0, 0, 0, 0.05); max-width: 850px; width: 100%; overflow: hidden; }
        h1, h2, h3, h4 { color: var(--primary-color); margin-bottom: 1.25rem; font-weight: 600; text-align: center; }
        h1 { font-size: 2rem; margin-bottom: 1.5rem; } h2 { font-size: 1.75rem; color: var(--dark-gray); }
        h3 { font-size: 1.5rem; color: var(--text-color); margin-top: 2rem; }
        h4 { font-size: 1.1rem; color: var(--secondary-color); margin-top: 1.5rem; margin-bottom: 0.75rem; padding-bottom: 0.3rem; border-bottom: 1px solid var(--border-color); text-align: left; }
        p { margin-bottom: 1rem; color: var(--text-muted-color); text-align: justify; }
        #home p { text-align: center; }
        button { display: inline-block; background-color: var(--primary-color); color: var(--card-bg-color); border: 1px solid transparent; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-size: 0.95rem; font-weight: 600; transition: all 0.2s ease; margin: 5px; box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05); }
        button:hover { filter: brightness(1.1); box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1); }
        button:active { filter: brightness(0.95); transform: translateY(1px); }
        button.secondary { background-color: var(--secondary-color); }
        button.outline { background-color: var(--card-bg-color); color: var(--primary-color); border-color: var(--primary-color); }
        button.outline:hover { background-color: var(--light-gray); filter: none; }
        button:disabled { background-color: var(--medium-gray); color: var(--dark-gray); cursor: not-allowed; box-shadow: none; filter: grayscale(50%); }
        .view { display: none; } .view.active { display: block; animation: fadeIn 0.4s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        section > *:not(:last-child) { margin-bottom: 1.5rem; }
        .actions-container { display: flex; justify-content: center; gap: 15px; flex-wrap: wrap; margin-top: 2rem; }
        #home h1 + p { margin-top: -0.5rem; margin-bottom: 2rem; }
        /* Styles pour les sections de reprise et r√©sultat sauvegard√© */
        .info-box { margin-top: 2rem; padding: 15px; background-color: var(--light-gray); border: 1px solid var(--border-color); border-radius: 8px; font-size: 0.9em; color: var(--text-muted-color); display: none; text-align: center; }
        .info-box p { margin-bottom: 0.8rem; text-align: center; } .info-box button { margin-top: 0.5rem; }
        #resume-test-info p, #saved-result-info p { margin-bottom: 0.8rem !important; } /* Override general p margin */
        #test h2 { margin-bottom: 1rem; } #test p:first-of-type { text-align: center; color: var(--text-muted-color); margin-bottom: 0.5rem; font-size: 0.9em;}
        #test-progress-container { width: 100%; background-color: var(--border-color); border-radius: 99px; margin-bottom: 2rem; overflow: hidden; height: 12px; }
        #test-progress { height: 100%; width: 0%; background-color: var(--secondary-color); transition: width 0.3s ease; border-radius: 99px; }
        #question-container { margin-bottom: 2rem; min-height: 250px; }
        .question-item { margin-bottom: 2.5rem; padding-bottom: 1.5rem; border-bottom: 1px solid var(--border-color); }
        .question-item:last-child { border-bottom: none; } .question-item p { font-weight: 600; margin-bottom: 1rem; color: var(--text-color); text-align: left; }
        .likert-scale { display: flex; flex-wrap: wrap; justify-content: space-around; gap: 10px; padding: 10px 0; border: 1px solid var(--border-color); border-radius: 8px; background-color: var(--light-gray); }
        .likert-scale label { display: flex; flex-direction: column; align-items: center; text-align: center; cursor: pointer; font-size: 0.8rem; color: var(--text-muted-color); padding: 8px 5px; border-radius: 6px; min-width: 70px; transition: background-color 0.2s ease; }
        .likert-scale input[type="radio"] { margin-bottom: 6px; accent-color: var(--primary-color); transform: scale(1.1); }
        .likert-scale label:hover { background-color: #e9ecef; } .likert-scale input[type="radio"]:checked + span { font-weight: 600; color: var(--primary-color); }
        #test-navigation { display: flex; justify-content: space-between; align-items: center; margin-top: 2rem; padding-top: 1rem; border-top: 1px solid var(--border-color); }
        #test .actions-container { margin-top: 1rem; justify-content: center; }
        #results h2 { margin-bottom: 1rem; }
        #results-summary { text-align: center; margin-bottom: 2.5rem; padding: 20px; background-color: var(--light-gray); border: 1px solid var(--border-color); border-radius: 8px; }
        #results-summary h2 { margin-bottom: 0.75rem; font-size: 1.5rem; color: var(--text-color); }
        #results-summary h2 span { font-weight: 700; } #results-summary p { color: var(--text-muted-color); font-size: 0.95rem; margin-bottom: 0; }
        #results h3 { font-size: 1.3rem; color: var(--text-color); margin-bottom: 1rem; }
        #results-chart { display: flex; justify-content: space-around; align-items: flex-end; height: 220px; border-bottom: 2px solid var(--medium-gray); padding-bottom: 10px; margin-bottom: 2.5rem; position: relative; }
        .chart-bar-container { display: flex; flex-direction: column; align-items: center; width: 9%; text-align: center; height: 100%; justify-content: flex-end; }
        .chart-bar { width: 100%; transition: height 0.6s cubic-bezier(0.25, 1, 0.5, 1); border-radius: 5px 5px 0 0; position: relative; margin-bottom: 8px; }
        .chart-bar::after { content: attr(data-score); position: absolute; top: -25px; left: 50%; transform: translateX(-50%); background: rgba(31, 41, 55, 0.85); color: var(--card-bg-color); padding: 4px 8px; border-radius: 6px; font-size: 0.8rem; font-weight: 600; white-space: nowrap; opacity: 0; visibility: hidden; transition: opacity 0.2s, visibility 0.2s; z-index: 10; }
        .chart-bar:hover::after { opacity: 1; visibility: visible; } .chart-label { font-size: 0.9rem; color: var(--dark-gray); font-weight: 600; }
        #results-actions { display: flex; justify-content: center; gap: 15px; flex-wrap: wrap; margin-top: 2rem; }
        #types h2 { margin-bottom: 2rem; }
        #type-selection { display: flex; flex-wrap: wrap; justify-content: center; gap: 12px; margin-bottom: 2.5rem; padding-bottom: 1.5rem; border-bottom: 1px solid var(--border-color); }
        .type-button { padding: 10px; min-width: 50px; height: 50px; font-size: 1.2rem; font-weight: 700; line-height: 1; display: flex; align-items: center; justify-content: center; }
        .type-button.type-color-1 { border-color: var(--type1-color); color: var(--type1-color); } .type-button.type-color-2 { border-color: var(--type2-color); color: var(--type2-color); }
        .type-button.type-color-3 { border-color: var(--type3-color); color: var(--type3-color); } .type-button.type-color-4 { border-color: var(--type4-color); color: var(--type4-color); }
        .type-button.type-color-5 { border-color: var(--type5-color); color: var(--type5-color); } .type-button.type-color-6 { border-color: var(--type6-color); color: var(--type6-color); }
        .type-button.type-color-7 { border-color: var(--type7-color); color: var(--type7-color); } .type-button.type-color-8 { border-color: var(--type8-color); color: var(--type8-color); }
        .type-button.type-color-9 { border-color: var(--type9-color); color: var(--type9-color); }
        .type-button:hover { opacity: 0.8; background-color: var(--light-gray); }
        .type-button.selected { background-color: var(--primary-color); color: white; }
        #type-detail-content { margin-top: 2rem; padding: 25px; border: 1px solid var(--border-color); border-radius: 8px; position: relative; overflow: hidden; background-color: #fff; display: none; /* Hidden by default */ }
        #type-detail-content::before { content: ''; position: absolute; left: 0; top: 0; bottom: 0; width: 6px; background-color: var(--border-color); transition: background-color 0.3s ease; }
        #type-detail-content h3:first-child { margin-top: 0; text-align: left; margin-bottom: 1.5rem; }
        .type-detail-section p { text-align: left; } .type-detail-section strong { color: var(--text-color); font-weight: 600; }
        #comparison h2 { margin-bottom: 1rem; } #comparison p:first-of-type { margin-bottom: 2rem; text-align: center; color: var(--text-muted-color);}
        #comparison-selectors { display: flex; justify-content: center; align-items: center; margin-bottom: 2rem; gap: 25px; flex-wrap: wrap; }
        #comparison-selectors label { margin-right: 8px; font-weight: 600; color: var(--text-color); }
        #comparison-selectors select { padding: 10px 15px; border: 1px solid var(--medium-gray); border-radius: 6px; min-width: 200px; background-color: var(--card-bg-color); font-size: 0.95rem; cursor: pointer; }
        #comparison .actions-container:nth-of-type(1) { margin-top: 0; margin-bottom: 2rem; }
        #comparison-result { margin-top: 2rem; padding: 20px; background-color: var(--light-gray); border: 1px solid var(--border-color); border-radius: 8px; min-height: 60px; }
        #comparison-result h4 { color: var(--primary-color); text-align: center; margin-top: 0; margin-bottom: 1rem; border-bottom: none; }
        #comparison-result p { text-align: left; } #comparison-result em { font-size: 0.85rem; color: var(--text-muted-color); }
        #comparison .actions-container:nth-of-type(2) { margin-top: 2rem; padding-top: 1rem; border-top: 1px solid var(--border-color); }
        @media (max-width: 768px) { #app { padding: 20px 25px; } h1 { font-size: 1.8rem; } h2 { font-size: 1.5rem; } h3 { font-size: 1.3rem; } button { padding: 10px 18px; font-size: 0.9rem; } .actions-container { gap: 10px; } #results-chart { height: 180px; } .chart-bar-container { width: 10%; } .chart-label { font-size: 0.8rem; } .chart-bar::after { font-size: 0.7rem; padding: 3px 6px; top: -22px; } #comparison-selectors { flex-direction: column; gap: 15px; align-items: stretch;} #comparison-selectors select { width: 100%; min-width: auto; } }
        @media (max-width: 480px) { body { padding: 15px 5px; } #app { padding: 15px; } h1 { font-size: 1.6rem; } h2 { font-size: 1.3rem; } h3 { font-size: 1.15rem; } button { padding: 9px 15px; font-size: 0.85rem; } .actions-container { gap: 8px; } .likert-scale label { min-width: 55px; font-size: 0.75rem; } .likert-scale { justify-content: center; gap: 5px; } #results-chart { height: 160px; } .chart-label { font-size: 0.7rem; } .chart-bar::after { display: none; } #type-selection { gap: 8px; } .type-button { min-width: 45px; height: 45px; font-size: 1rem; } #type-detail-content { padding: 15px; } }
        .type-bg-1 { background-color: var(--type1-color); } .type-bg-2 { background-color: var(--type2-color); } .type-bg-3 { background-color: var(--type3-color); } .type-bg-4 { background-color: var(--type4-color); } .type-bg-5 { background-color: var(--type5-color); } .type-bg-6 { background-color: var(--type6-color); } .type-bg-7 { background-color: var(--type7-color); } .type-bg-8 { background-color: var(--type8-color); } .type-bg-9 { background-color: var(--type9-color); }
        .type-border-1::before { background-color: var(--type1-color); } .type-border-2::before { background-color: var(--type2-color); } .type-border-3::before { background-color: var(--type3-color); } .type-border-4::before { background-color: var(--type4-color); } .type-border-5::before { background-color: var(--type5-color); } .type-border-6::before { background-color: var(--type6-color); } .type-border-7::before { background-color: var(--type7-color); } .type-border-8::before { background-color: var(--type8-color); } .type-border-9::before { background-color: var(--type9-color); }
        .type-text-1 { color: var(--type1-color); } .type-text-2 { color: var(--type2-color); } .type-text-3 { color: var(--type3-color); } .type-text-4 { color: var(--type4-color); } .type-text-5 { color: var(--type5-color); } .type-text-6 { color: var(--type6-color); } .type-text-7 { color: var(--type7-color); } .type-text-8 { color: var(--type8-color); } .type-text-9 { color: var(--type9-color); }
        
        /* NOUVEAU STYLE POUR LA BANNI√àRE DE PROMOTION */
        .promo-banner {
            background-color: var(--secondary-color); /* Orange vif */
            color: #800000;
            padding: 15px 20px;
            text-align: center;
            font-size: 1.1em;
            font-weight: 600;
            border-radius: 8px;
            margin-bottom: 25px; /* Espace sous la banni√®re */
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            animation: pulse 2s infinite ease-in-out; /* Animation subtile */
            border: 2px solid var(--primary-color); /* Bordure pour contraste */
        }
        .promo-banner a {
            color: white;
            text-decoration: underline;
            font-weight: 700;
            transition: color 0.3s ease;
        }
        .promo-banner a:hover {
            color: var(--primary-color); /* Changement de couleur au survol */
            text-decoration: none;
        }

        /* Animation Keyframes */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.01); }
            100% { transform: scale(1); }
        }

        @media (max-width: 768px) {
            .promo-banner {
                font-size: 1em;
                padding: 12px 15px;
                margin-bottom: 20px;
            }
        }
        @media (max-width: 480px) {
            .promo-banner {
                font-size: 0.9em;
                padding: 10px 10px;
                margin-bottom: 15px;
            }
        }    
    
    
    
    </style>
</head>
<body>
    <div id="app">

        <div class="promo-banner">
            D√©couvrez "Le Chemin de la Conscience : Une Collection sur l'Enn√©agramme (9 livres)" !
            <a href="https://www.amazon.fr/dp/B0FRMN612N" target="_blank" rel="noopener noreferrer">
                Cliquez ici pour explorer la s√©rie sur Amazon.
            </a>
        </div>
        <!-- ==== HOME VIEW ==== -->
        <section id="home" class="view active">
            <h1>Bienvenue sur l'Explorateur d'Enn√©agramme</h1>
            <p>Pr√™t(e) √† identifier votre type de personnalit√© selon le mod√®le riche et nuanc√© de l'Enn√©agramme ? Ce syst√®me vous permet de mieux cerner vos motivations profondes, de reconna√Ætre vos plus grandes forces et de mettre en lumi√®re vos opportunit√©s de d√©veloppement personnel. Pour d√©marrer cette exploration enrichissante et obtenir un profil d√©taill√©, choisissez l'option qui vous convient : le Test Rapide (environ 54 questions) pour un aper√ßu efficace, ou le Test Complet (environ 108 questions) pour une investigation plus approfondie et pr√©cise.</p>
            <div class="actions-container">
                <button id="start-short-test-btn" class="primary">Test Rapide (~54 Q)</button>
                <button id="start-long-test-btn" class="secondary">Test Complet (~108 Q)</button>
            </div>
            <div class="actions-container" style="margin-top: 1rem;">
                 <button id="view-types-home-btn" class="outline">Explorer les 9 Types</button>
                 <button id="view-comparison-btn" class="outline">Comparer les Types</button>
            </div>

            <!-- AJOUT: Zone pour reprendre un test en cours -->
            <div id="resume-test-info" class="info-box">
                <p>Un test est en cours (<span id="resume-test-level-info"></span>, page <span id="resume-page-info"></span>). Voulez-vous le reprendre ?</p>
                <div class="actions-container" style="margin-top: 0.5rem;">
                    <button id="resume-test-btn" class="outline">Reprendre le Test</button>
                    <button id="abandon-test-btn" class="outline" style="border-color: var(--danger-color); color: var(--danger-color);">Abandonner et Nouveau Test</button>
                </div>
            </div>

            <!-- MODIFICATION: Utilisation de la classe info-box pour la coh√©rence -->
            <div id="saved-result-info" class="info-box">
                <p>Un r√©sultat de test pr√©c√©dent a √©t√© trouv√©.</p>
                 <div class="actions-container" style="margin-top: 0.5rem;">
                    <button id="show-saved-result-btn" class="outline">Afficher</button>
                    <button id="clear-saved-result-btn" class="outline" style="border-color: var(--danger-color); color: var(--danger-color);">Effacer</button>
                 </div>
            </div>
        </section>

        <!-- ==== TEST VIEW ==== -->
        <section id="test" class="view">
            <h2 id="test-title">Questionnaire Enn√©agramme</h2>
            <p>Question <span id="current-q-number">1</span> √† <span id="end-q-number">?</span> sur <span id="total-q-number">?</span></p> <!-- MODIFICATION: Affichage de la plage de questions -->
            <div id="test-progress-container"> <div id="test-progress"></div> </div>
            <div id="question-container"></div>
            <div id="test-navigation">
                <button id="prev-btn" class="outline" disabled>Pr√©c√©dent</button>
                <button id="next-btn">Suivant</button>
                <button id="finish-btn" class="secondary" style="display: none;">Voir mes R√©sultats</button>
            </div>
             <div class="actions-container">
                 <!-- MODIFICATION: Le bouton sauvegarde maintenant l'√©tat en cours et retourne √† l'accueil -->
                 <button id="save-and-return-btn" class="outline" style="border-color: var(--primary-color); color: var(--primary-color);">Sauvegarder et retour √† l'accueil</button>
             </div>
        </section>

        <!-- ==== RESULTS VIEW ==== -->
        <section id="results" class="view">
            <h2>Vos R√©sultats</h2>
             <p id="results-test-info" style="text-align: center; color: var(--text-muted-color); margin-top:-1rem; font-size:0.9em;">R√©sultats bas√©s sur le test <span id="results-test-level">?</span>.</p>
            <div id="results-summary">
                 <h2>Type principal : <span id="main-type-name">?</span> (<span id="main-type-number">?</span>)</h2>
                 <p id="wings-info">...</p>
            </div>
            <h3>Scores par type :</h3>
            <div id="results-chart"></div>
            <div id="results-actions" class="actions-container">
                <button id="view-my-type-details-btn">D√©tails de mon type</button>
                <button id="explore-other-types-btn" class="secondary">Explorer les types</button>
                <button id="redo-test-btn" class="outline">Refaire un test</button>
            </div>
        </section>

        <!-- ==== TYPES VIEW ==== -->
        <section id="types" class="view">
            <h2>Les 9 Types de l'Enn√©agramme</h2>
            <div id="type-selection"></div>
            <div id="type-detail-content">
                 <!-- Contenu dynamique charg√© ici -->
            </div>
             <div class="actions-container" style="margin-top: 2rem; padding-top: 1rem; border-top: 1px solid var(--border-color);">
                  <button id="types-back-btn" class="outline">Retour</button>
             </div>
        </section>

         <!-- ==== COMPARISON VIEW ==== -->
        <section id="comparison" class="view">
            <h2>Comparaison Relationnelle</h2>
            <p>S√©lectionnez deux types pour d√©couvrir un aper√ßu de leur dynamique.</p>
             <div id="comparison-selectors">
                 <div> <label for="compare-type1">Type 1 :</label> <select id="compare-type1"></select> </div>
                 <div> <label for="compare-type2">Type 2 :</label> <select id="compare-type2"></select> </div>
            </div>
             <div class="actions-container"> <button id="compare-btn" class="primary">Comparer</button> </div>
             <div id="comparison-result"></div>
             <div class="actions-container">
                 <button id="comparison-back-btn" class="outline">Retour √† l'accueil</button>
             </div>
        </section>

        <!-- ==== PUBLICIT√â BAS DE PAGE (Style existant info-box) ==== -->
        <div class="info-box" style="display: block; margin-top: 3rem;">
            <h4 style="border: none; text-align: center; margin-bottom: 0.5rem;">Besoin d'aide pour interpr√©ter vos r√©sultats ?</h4>
            
            <p style="text-align: center;">
                L'Enn√©agramme est un outil puissant, mais complexe. Pour aller plus loin dans votre d√©veloppement personnel, faites-vous accompagner par une experte.
            </p>
            
            <div class="actions-container">
                <a href="http://www.helene-mimenza-coaching.com/" target="_blank" rel="noopener noreferrer" style="text-decoration: none;">
                    <!-- On utilise la classe "secondary" existante pour avoir le bouton orange -->
                    <button class="secondary">‚ú® D√©couvrir H√©l√®ne Mimenza Coaching</button>
                </a>
            </div>
        </div>

    </div>



    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // ---=== DATABASE (Identique) ===---
            const enneagramData = {
                1: { name: "Le Perfectionniste", color: "var(--type1-color)", icon: "üéØ", description: "Principl√©, d√©termin√©, contr√¥l√© et perfectionniste. Recherche l'int√©grit√© et l'am√©lioration.", strengths: "√âthique, fiable, productif, sage, id√©aliste, organis√©.", weaknesses: "Critique (soi et autres), jugement, rigidit√©, ressentiment, peur de l'erreur.", motivation: "√ätre bon, avoir raison, √™tre juste, √©viter la critique.", fear: "√ätre corrompu, mauvais, d√©fectueux, irresponsable.", stress: "Devient plus critique, rigide et moralisateur", security: "Se d√©tend, devient plus spontan√© et accepte l'imperfection", growth: "Accepter l'imperfection (en soi et chez les autres), cultiver la s√©r√©nit√© et la patience, d√©velopper l'empathie.", tips: "Pratiquer la pleine conscience de la critique int√©rieure, c√©l√©brer les progr√®s (pas seulement la perfection), d√©l√©guer, apprendre √† se d√©tendre.", growthPath: 4, securityPath: 7 },
                2: { name: "L'Altruiste", color: "var(--type2-color)", icon: "‚ù§Ô∏è", description: "Attentionn√©, g√©n√©reux, ax√© sur les relations, mais peut √™tre possessif ou manipulateur.", strengths: "Aimant, attentionn√©, g√©n√©reux, empathique, soutenant.", weaknesses: "Fiert√© (de ne pas avoir besoin d'aide), d√©pendance affective, manipulation indirecte, difficult√© √† dire non.", motivation: "√ätre aim√©, √™tre n√©cessaire, √™tre appr√©ci√©.", fear: "Ne pas √™tre aim√©, ne pas √™tre voulu, √™tre rejet√©.", stress: "Devient plus agressif, autoritaire et potentiellement manipulateur", security: "Devient plus conscient de ses propres besoins et limites, plus authentique", growth: "Reconna√Ætre et exprimer ses propres besoins, fixer des limites saines, apprendre √† recevoir, aimer sans attente de retour.", tips: "Tenir un journal de ses besoins/sentiments, pratiquer √† dire 'non' poliment, demander de l'aide, s'offrir des moments pour soi.", growthPath: 8, securityPath: 4 },
                3: { name: "Le Battant", color: "var(--type3-color)", icon: "‚≠ê", description: "Orient√© succ√®s, adaptable, efficace, mais peut √™tre vaniteux et trop centr√© sur l'image.", strengths: "Ambitieux, efficace, confiant, √©nergique, motivant, adaptable.", weaknesses: "Comp√©titif √† l'exc√®s, 'workaholic', vaniteux, peur de l'√©chec, d√©connexion des sentiments.", motivation: "√ätre valoris√©, admir√©, avoir du succ√®s, √™tre le meilleur.", fear: "Ne pas avoir de valeur intrins√®que, √©chouer, √™tre per√ßu comme incomp√©tent.", stress: "Se replie, devient apathique, perd sa motivation", security: "Devient plus coop√©ratif, authentique et attach√© aux autres", growth: "Cultiver l'authenticit√© (sentiments vs image), valoriser les relations pour elles-m√™mes, ralentir, accepter l'√©chec comme apprentissage.", tips: "Identifier ses vraies valeurs (pas seulement celles qui r√©ussissent), planifier du temps 'off' sans objectif de performance, pratiquer l'√©coute active.", growthPath: 9, securityPath: 6 },
                4: { name: "Le Romantique", color: "var(--type4-color)", icon: "üé®", description: "Introspectif, expressif, unique, mais peut √™tre m√©lancolique et auto-absorb√©.", strengths: "Cr√©atif, sensible, introspectif, authentique, empathique, profond.", weaknesses: "Lunatique, m√©lancolique, auto-absorb√©, envieux, sentiment d'incompl√©tude.", motivation: "√ätre unique, authentique, compris, trouver son identit√©.", fear: "Ne pas avoir d'identit√© propre, √™tre insignifiant, ordinaire, abandonn√©.", stress: "Devient excessivement d√©pendant, en demande d'attention, s'accroche aux autres", security: "Devient plus objectif, engag√© dans l'action et moins submerg√© par les √©motions", growth: "Appr√©cier le pr√©sent et l'ordinaire, cultiver la gratitude, agir malgr√© l'humeur, √©quilibrer √©motion et raison.", tips: "Pratiquer la gratitude quotidienne, s'engager dans des actions cr√©atives concr√®tes, reconna√Ætre la valeur dans le 'commun', rester ancr√©.", growthPath: 2, securityPath: 1 },
                5: { name: "L'Observateur", color: "var(--type5-color)", icon: "üß†", description: "Perspicace, curieux, ind√©pendant, mais peut √™tre d√©tach√© et isol√©.", strengths: "Analytique, perspicace, curieux, ind√©pendant, objectif, calme.", weaknesses: "D√©tach√© √©motionnellement, avare (temps, √©nergie, savoir), isol√©, peur de l'engagement.", motivation: "√ätre comp√©tent, capable, savoir, comprendre.", fear: "√ätre inutile, incapable, impuissant, envahi, submerg√© par les besoins des autres.", stress: "Devient hyperactif, dispers√©, recherche fr√©n√©tiquement des distractions", security: "Devient plus confiant, engag√©, assertif et connect√© √† son corps", growth: "S'engager avec le monde et les √©motions, partager ses ressources (savoir, temps), connecter corps et esprit.", tips: "Pratiquer l'incarnation (sport, danse, nature), fixer des limites au temps de recherche, s'entra√Æner √† partager ses id√©es/sentiments, agir avant d'√™tre 'pr√™t'.", growthPath: 7, securityPath: 8 },
                6: { name: "Le Loyaliste", color: "var(--type6-color)", icon: "üõ°Ô∏è", description: "Engag√©, responsable, orient√© s√©curit√©, mais peut √™tre anxieux et m√©fiant.", strengths: "Loyal, responsable, travailleur, pr√©voyant, courageux (face aux peurs).", weaknesses: "Anxieux, ind√©cis, m√©fiant, pessimiste, projette ses peurs.", motivation: "Avoir s√©curit√©, soutien, certitude.", fear: "√ätre sans soutien, abandonn√©, incapable de survivre seul, faire une erreur irr√©parable.", stress: "Devient comp√©titif, arrogant, cherche √† prouver sa valeur", security: "Devient plus d√©tendu, confiant, optimiste et en paix", growth: "Faire confiance √† son propre jugement int√©rieur, g√©rer l'anxi√©t√© sans la laisser paralyser, accepter l'incertitude, agir malgr√© la peur.", tips: "Identifier les sc√©narios catastrophes vs r√©alit√©s, pratiquer la prise de d√©cision (m√™me petites), chercher des preuves de soutien (au lieu de preuves de danger), m√©ditation.", growthPath: 3, securityPath: 9 },
                7: { name: "L'√âpicurien", color: "var(--type7-color)", icon: "üéâ", description: "Optimiste, spontan√©, polyvalent, mais peut √™tre dispers√© et √©viter la douleur.", strengths: "Optimiste, √©nergique, curieux, spontan√©, visionnaire, joyeux.", weaknesses: "Superficiel, impulsif, dispers√©, √©vite la douleur et l'ennui, difficult√© √† s'engager.", motivation: "√ätre satisfait, content, libre, √©viter la souffrance et la limitation.", fear: "√ätre priv√©, pi√©g√© dans la souffrance ou l'ennui, manquer quelque chose d'important.", stress: "Devient critique, perfectionniste, rigide", security: "Devient plus concentr√©, profond, capable d'introspection et d'engagement", growth: "Accepter et traverser la douleur et l'ennui, s'engager en profondeur (projets, relations), trouver la joie dans la simplicit√©, appr√©cier le pr√©sent.", tips: "Pratiquer la pleine conscience, finir les projets commenc√©s, explorer volontairement les √©motions difficiles, limiter les options.", growthPath: 1, securityPath: 5 },
                8: { name: "Le Protecteur", color: "var(--type8-color)", icon: "üëë", description: "Puissant, assertif, protecteur, mais peut √™tre contr√¥lant et intimidant.", strengths: "Protecteur, d√©cisif, volontaire, √©nergique, juste, leader naturel.", weaknesses: "Contr√¥lant, dominateur, insensible (surtout √† la vuln√©rabilit√©), vengeur, excessif.", motivation: "Se prot√©ger (et prot√©ger les siens), contr√¥ler son environnement, √™tre fort.", fear: "√ätre contr√¥l√©, bless√©, faible, vuln√©rable, trahi.", stress: "Se retire, devient secret, craintif et isol√©", security: "Devient plus attentionn√©, ouvert de c≈ìur, utilise sa force pour soutenir", growth: "D√©velopper la vuln√©rabilit√©, reconna√Ætre l'impact de sa force, √©couter les autres, utiliser sa puissance au service des autres (pas seulement pour le contr√¥le).", tips: "Pratiquer l'√©coute active, remarquer sa r√©activit√© physique √† la vuln√©rabilit√© (la sienne ou celle des autres), s'excuser sinc√®rement, choisir ses combats.", growthPath: 5, securityPath: 2 },
                9: { name: "Le M√©diateur", color: "var(--type9-color)", icon: "‚òÆÔ∏è", description: "Paisible, agr√©able, r√©ceptif, mais peut √™tre complaisant et √©viter les conflits.", strengths: "Accommodant, diplomate, patient, stable, inclusif, apaisant.", weaknesses: "Procrastinateur, ind√©cis, passif-agressif, t√™tu (inertie), difficult√© √† identifier ses propres besoins/col√®re.", motivation: "Maintenir la paix int√©rieure et l'harmonie ext√©rieure, √©viter les conflits.", fear: "Perte, s√©paration, conflit, tension, √™tre ignor√©.", stress: "Devient anxieux, inquiet, submerg√©", security: "Devient plus affirm√©, √©nergique, orient√© objectifs", growth: "S'affirmer, reconna√Ætre et accepter sa propre col√®re comme √©nergie, d√©finir ses priorit√©s, agir pour ses propres d√©sirs.", tips: "Identifier ses propres d√©sirs (m√™me petits), pratiquer l'affirmation de soi ('Je veux...', 'Je pense...'), reconna√Ætre les signes physiques de la col√®re/tension, agir par petits pas.", growthPath: 6, securityPath: 3 }
            };
            const relationshipMatrix = { /* ... (Matrice compl√®te coll√©e ici) ... */
                "1-1": "Partage de valeurs √©lev√©es, discipline mutuelle. Risque de critiques r√©ciproques excessives et de rigidit√©.",
                "1-2": "Le 1 apporte la structure, le 2 la chaleur humaine. Le 1 peut trouver le 2 trop √©motif ou indirect, le 2 peut se sentir insuffisamment appr√©ci√© ou critiqu√© par le 1.",
                "1-3": "Focalisation sur l'efficacit√© et l'action. Peuvent √™tre une √©quipe tr√®s productive. Risque de n√©gliger les aspects √©motionnels et relationnels.",
                "1-4": "Le 1 est pratique, le 4 est id√©aliste/√©motionnel. Attraction possible par les diff√©rences, mais risque d'incompr√©hension mutuelle (logique vs sentiment).",
                "1-5": "Combinaison de rigueur (1) et d'analyse (5). Peuvent collaborer sur des projets intellectuels. Risque de d√©tachement √©motionnel excessif.",
                "1-6": "Partage d'un sens du devoir et de la responsabilit√©. Le 1 peut trouver le 6 trop anxieux, le 6 peut trouver le 1 trop critique ou rigide.",
                "1-7": "Contraste entre la discipline du 1 et la spontan√©it√© du 7. Le 1 peut aider le 7 √† se structurer, le 7 peut aider le 1 √† se d√©tendre. Risque fort de jugement (1->7) et de sentiment d'√™tre limit√© (7->1).",
                "1-8": "Alliance de force et de principes. Peuvent √™tre puissants ensemble pour une cause. Risque de lutte pour le contr√¥le et d'insensibilit√© mutuelle.",
                "1-9": "Le 1 apporte l'ordre, le 9 la paix. Peuvent se stabiliser. Le 1 peut reprocher au 9 son inaction, le 9 peut trouver le 1 trop exigeant.",
                "2-2": "Tr√®s centr√©s sur la relation et l'aide. Risque de n√©gliger leurs propres besoins et de devenir co-d√©pendants.",
                "2-3": "Le 2 soutient le succ√®s du 3, le 3 appr√©cie l'admiration du 2. Risque que la relation devienne superficielle ou bas√©e sur l'image.",
                "2-4": "Forte connexion √©motionnelle possible. Le 2 apporte le soutien, le 4 la profondeur. Risque de montagnes russes √©motionnelles et de d√©pendance affective.",
                "2-5": "Le 2 tente de 'r√©chauffer' le 5, le 5 peut se sentir envahi. Le 5 apporte l'objectivit√©, le 2 la connexion. N√©cessite beaucoup de respect des limites.",
                "2-6": "Le 2 rassure le 6 anxieux, le 6 appr√©cie la loyaut√© du 2. Risque de d√©pendance mutuelle et de difficult√© √† g√©rer les conflits ouverts.",
                "2-7": "Le 2 est attir√© par la joie du 7, le 7 par la g√©n√©rosit√© du 2. Le 2 peut se sentir n√©glig√©, le 7 peut se sentir √©touff√© par les attentes.",
                "2-8": "Le 2 admire la force du 8, le 8 appr√©cie le soutien du 2. Dynamique protectrice. Risque de contr√¥le (8) et de manipulation affective (2).",
                "2-9": "Relation douce et attentionn√©e. Le 2 prend soin, le 9 maintient l'harmonie. Risque d'√©vitement des probl√®mes et de manque d'affirmation.",
                "3-3": "Tr√®s ax√©s sur l'image et le succ√®s. Peuvent √™tre un 'power couple'. Risque de comp√©tition et de manque d'authenticit√© √©motionnelle.",
                "3-4": "Le 3 est orient√© action/image, le 4 authenticit√©/√©motion. Le 4 peut trouver le 3 superficiel, le 3 peut trouver le 4 trop lunatique. Attraction possible mais d√©fi d'int√©gration.",
                "3-5": "Focalisation sur la comp√©tence et l'efficacit√©. Le 3 ex√©cute, le 5 analyse. Peuvent bien travailler ensemble. Risque de n√©gliger la connexion humaine.",
                "3-6": "Le 3 apporte la confiance, le 6 la prudence. Peuvent s'√©quilibrer si le 3 ne m√©prise pas les doutes du 6 et si le 6 ne freine pas trop le 3.",
                "3-7": "Tr√®s √©nergique, orient√© vers l'action, les projets et les nouvelles exp√©riences. Le 3 apporte l'objectif, le 7 l'enthousiasme. S'encouragent mutuellement. Risque d'√©viter les probl√®mes de fond, la profondeur √©motionnelle ou l'engagement durable.",
                "3-8": "Combinaison d'ambition (3) et de puissance (8). Tr√®s forts pour atteindre des objectifs concrets. Risque de conflit d'ego et de lutte pour le leadership.",
                "3-9": "Le 3 est actif, le 9 est r√©ceptif. Le 9 admire l'√©nergie du 3, le 3 appr√©cie le calme du 9. Le 3 peut pousser le 9, mais risque de le surmener ou de ne pas le voir.",
                "4-4": "Profonde connexion √©motionnelle et compr√©hension mutuelle unique. Risque de se perdre dans la m√©lancolie, le drame ou l'isolement √† deux.",
                "4-5": "Monde int√©rieur riche (4) rencontre monde intellectuel riche (5). Peuvent s'appr√©cier mutuellement. Le 4 peut d√©sirer plus d'expression √©motionnelle, le 5 plus d'espace.",
                "4-6": "Le 4 apporte la profondeur √©motionnelle, le 6 la loyaut√© et l'engagement. Le 4 peut trouver le 6 trop conventionnel/anxieux, le 6 peut trouver le 4 trop instable.",
                "4-7": "Le 4 cherche la profondeur, le 7 la nouveaut√©/le plaisir. Peuvent s'inspirer mutuellement (cr√©ativit√©/joie). Risque que le 7 fuie l'intensit√© du 4, et que le 4 trouve le 7 superficiel.",
                "4-8": "Le 4 appr√©cie l'authenticit√© et la force du 8, le 8 peut √™tre intrigu√© par la profondeur du 4. Risque de confrontations intenses dues √† leur nature passionn√©e.",
                "4-9": "Le 4 cherche l'intensit√© et l'unicit√©, le 9 recherche la paix et l'harmonie. Le 9 peut apaiser le 4, le 4 peut aider le 9 √† se connecter √† ses passions. Risque que le 4 trouve le 9 trop passif et que le 9 trouve le 4 trop dramatique ou exigeant.",
                "5-5": "Beaucoup d'espace personnel, compr√©hension mutuelle du besoin de retrait et d'analyse. Risque d'isolement excessif et de n√©gligence de la vie pratique ou √©motionnelle.",
                "5-6": "Le 5 apporte l'analyse, le 6 la planification des risques. Peuvent former une √©quipe prudente et comp√©tente. Le 5 peut trouver le 6 trop anxieux, le 6 peut trouver le 5 trop d√©tach√©.",
                "5-7": "Combinaison d'exploration mentale (5) et d'exploration exp√©rientielle (7). Stimulant intellectuellement. Risque que le 7 trouve le 5 trop retir√© et que le 5 trouve le 7 trop dispers√©.",
                "5-8": "Alliance de la strat√©gie (5) et de la puissance (8). Peuvent √™tre tr√®s efficaces ensemble pour des objectifs clairs. Risque de lutte de pouvoir intellectuel vs action, ou de manque de chaleur.",
                "5-9": "Le 5 respecte l'autonomie du 9, le 9 appr√©cie le calme du 5. Relation peu exigeante. Risque de passivit√© et de manque d'engagement mutuel.",
                "6-6": "Partage d'une recherche de s√©curit√© et de loyaut√©. Grande compr√©hension mutuelle des angoisses. Risque de rester bloqu√©s dans l'ind√©cision ou la m√©fiance.",
                "6-7": "Le 6 apporte la prudence, le 7 l'optimisme. Peuvent s'√©quilibrer. Le 6 peut s'inqui√©ter de l'impulsivit√© du 7, le 7 peut se sentir frein√© par l'anxi√©t√© du 6.",
                "6-8": "Le 6 cherche un protecteur (8), le 8 aime prot√©ger (6). Relation bas√©e sur la force et la loyaut√©. Risque que le 8 devienne trop dominant et le 6 trop d√©pendant.",
                "6-9": "Recherche commune de s√©curit√© (6) et de confort (9). Peuvent cr√©er un environnement stable et pr√©visible. Risque d'inertie, de procrastination et d'√©vitement des conflits n√©cessaires.",
                "7-7": "Beaucoup d'√©nergie, d'optimisme et de recherche de plaisir. Tr√®s amusant au d√©but. Risque d'√©viter les responsabilit√©s, les √©motions difficiles et l'engagement profond.",
                "7-8": "Combinaison d'√©nergie et d'assertivit√©. Tr√®s actifs et entreprenants. Risque de confrontations explosives et de difficult√© √† ralentir.",
                "7-9": "Le 7 apporte l'√©nergie et l'optimisme, le 9 la paix et l'acceptation. Le 9 peut stabiliser le 7, le 7 peut dynamiser le 9. Risque que le 7 s'ennuie et que le 9 se sente d√©pass√©.",
                "8-8": "Relation intense, passionn√©e et directe. Respect mutuel de la force. Risque de luttes de pouvoir constantes et de manque de vuln√©rabilit√©.",
                "8-9": "Le 8 prend les devants, le 9 suit et apaise. Le 8 appr√©cie le calme du 9, le 9 la force protectrice du 8. Risque que le 8 domine excessivement et que le 9 perde sa voix.",
                "9-9": "Relation tr√®s paisible, confortable et harmonieuse. Compr√©hension mutuelle du besoin de tranquillit√©. Risque majeur d'inertie, de non-dits et de n√©gligence des probl√®mes."
            };
            const allQuestions = [ /* ... (Toutes les questions ici, inchang√©es) ... */
                 // Type 1 (12 questions: 6 short, 6 long)
                 { id: 1, text: "Je m'efforce constamment de m'am√©liorer et d'am√©liorer les choses autour de moi.", type: 1, level: ['short', 'long'] },
                 { id: 2, text: "Il est important pour moi d'√™tre juste, honn√™te et d'avoir de l'int√©grit√©.", type: 1, level: ['short', 'long'] },
                 { id: 3, text: "Je remarque facilement les erreurs et ce qui pourrait √™tre mieux fait.", type: 1, level: ['short', 'long'] },
                 { id: 101, text: "J'ai une forte critique int√©rieure qui me pousse √† faire de mon mieux.", type: 1, level: ['short', 'long'] },
                 { id: 102, text: "Je me sens responsable de faire les choses correctement.", type: 1, level: ['short', 'long'] },
                 { id: 103, text: "La procrastination ou le laxisme m'irritent, chez moi comme chez les autres.", type: 1, level: ['short', 'long'] },
                 { id: 104, text: "J'ai tendance √† organiser et planifier pour √©viter les probl√®mes.", type: 1, level: ['long'] },
                 { id: 105, text: "Je peux ressentir du ressentiment si les autres ne respectent pas les r√®gles ou les standards.", type: 1, level: ['long'] },
                 { id: 106, text: "Il m'est difficile de d√©l√©guer car j'ai peur que le travail ne soit pas bien fait.", type: 1, level: ['long'] },
                 { id: 107, text: "Je crois fermement qu'il y a une 'bonne' fa√ßon de faire les choses.", type: 1, level: ['long'] },
                 { id: 108, text: "Sous pression, je peux devenir encore plus rigide et critique.", type: 1, level: ['long'] },
                 { id: 109, text: "Accepter que tout ne soit pas parfait est un d√©fi pour moi.", type: 1, level: ['long'] },

                 // Type 2 (12 questions: 6 short, 6 long)
                 { id: 4, text: "Aider les autres et me sentir utile est une source majeure de satisfaction.", type: 2, level: ['short', 'long'] },
                 { id: 5, text: "Je suis tr√®s attentif(ve) aux besoins et aux sentiments des personnes qui m'entourent.", type: 2, level: ['short', 'long'] },
                 { id: 6, text: "J'ai parfois du mal √† reconna√Ætre ou √† exprimer mes propres besoins.", type: 2, level: ['short', 'long'] },
                 { id: 201, text: "Je fais beaucoup d'efforts pour √™tre aim√©(e) et appr√©ci√©(e).", type: 2, level: ['short', 'long'] },
                 { id: 202, text: "Je me sens fier(e) d'√™tre une personne sur qui les autres peuvent compter.", type: 2, level: ['short', 'long'] },
                 { id: 203, text: "Exprimer ma gratitude et mon affection envers les autres est naturel pour moi.", type: 2, level: ['short', 'long'] },
                 { id: 204, text: "Je peux me sentir bless√©(e) ou rejet√©(e) si mon aide n'est pas accept√©e ou reconnue.", type: 2, level: ['long'] },
                 { id: 205, text: "Il m'est difficile de dire 'non' aux demandes des autres.", type: 2, level: ['long'] },
                 { id: 206, text: "Je donne souvent des conseils ou mon aide sans qu'on me le demande explicitement.", type: 2, level: ['long'] },
                 { id: 207, text: "Je peux parfois utiliser la flatterie ou l'aide pour obtenir de l'affection.", type: 2, level: ['long'] },
                 { id: 208, text: "Sous stress, je peux devenir plus insistant(e) ou me plaindre de ne pas √™tre appr√©ci√©(e).", type: 2, level: ['long'] },
                 { id: 209, text: "L'id√©e d'√™tre seul(e) ou inutile me fait peur.", type: 2, level: ['long'] },

                 // Type 3 (12 questions: 6 short, 6 long)
                 { id: 7, text: "R√©ussir et atteindre mes objectifs est extr√™mement important pour moi.", type: 3, level: ['short', 'long'] },
                 { id: 8, text: "Je suis tr√®s conscient(e) de l'image que je projette et de la fa√ßon dont les autres me per√ßoivent.", type: 3, level: ['short', 'long'] },
                 { id: 9, text: "Je suis efficace, adaptable et je sais comment obtenir des r√©sultats.", type: 3, level: ['short', 'long'] },
                 { id: 301, text: "J'aime √™tre reconnu(e) et admir√©(e) pour mes succ√®s et mes comp√©tences.", type: 3, level: ['short', 'long'] },
                 { id: 302, text: "Je peux facilement mettre mes √©motions de c√¥t√© pour me concentrer sur la t√¢che √† accomplir.", type: 3, level: ['short', 'long'] },
                 { id: 303, text: "Je suis naturellement comp√©titif(ve) et motiv√©(e) par les d√©fis.", type: 3, level: ['short', 'long'] },
                 { id: 304, text: "J'ai tendance √† m'identifier fortement √† mon travail ou √† mes r√©ussites.", type: 3, level: ['long'] },
                 { id: 305, text: "L'√©chec est difficile √† accepter et je fais tout pour l'√©viter.", type: 3, level: ['long'] },
                 { id: 306, text: "Je peux parfois 'en faire trop' ou embellir la v√©rit√© pour para√Ætre plus impressionnant(e).", type: 3, level: ['long'] },
                 { id: 307, text: "Rester constamment occup√©(e) et productif(ve) me donne le sentiment d'avoir de la valeur.", type: 3, level: ['long'] },
                 { id: 308, text: "Sous pression, je peux devenir impatient(e) ou excessivement focalis√©(e) sur la performance.", type: 3, level: ['long'] },
                 { id: 309, text: "J'ai du mal √† ralentir et √† simplement '√™tre' sans rien faire.", type: 3, level: ['long'] },

                 // Type 4 (12 questions: 6 short, 6 long)
                 { id: 10, text: "Je me sens souvent diff√©rent(e) des autres, unique en mon genre.", type: 4, level: ['short', 'long'] },
                 { id: 11, text: "Mes √©motions sont profondes, intenses et tr√®s importantes pour moi.", type: 4, level: ['short', 'long'] },
                 { id: 12, text: "L'authenticit√© et l'expression de soi sont des valeurs fondamentales pour moi.", type: 4, level: ['short', 'long'] },
                 { id: 401, text: "Je suis attir√©(e) par la beaut√©, la profondeur et ce qui sort de l'ordinaire.", type: 4, level: ['short', 'long'] },
                 { id: 402, text: "J'ai parfois l'impression qu'il manque quelque chose d'essentiel dans ma vie.", type: 4, level: ['short', 'long'] },
                 { id: 403, text: "Je peux passer beaucoup de temps √† explorer mes sentiments et mon monde int√©rieur.", type: 4, level: ['short', 'long'] },
                 { id: 404, text: "Je peux √™tre sujet(te) √† la m√©lancolie ou √† des changements d'humeur.", type: 4, level: ['long'] },
                 { id: 405, text: "L'envie de ce que les autres semblent avoir (et que je n'ai pas) peut parfois me tourmenter.", type: 4, level: ['long'] },
                 { id: 406, text: "J'ai besoin de me sentir compris(e) dans ma singularit√©.", type: 4, level: ['long'] },
                 { id: 407, text: "Je suis souvent plus √† l'aise avec la tristesse ou la nostalgie qu'avec la joie simple.", type: 4, level: ['long'] },
                 { id: 408, text: "Sous stress, je peux me replier sur moi-m√™me ou devenir excessivement dramatique.", type: 4, level: ['long'] },
                 { id: 409, text: "Cr√©er quelque chose d'original est une fa√ßon importante pour moi de m'exprimer.", type: 4, level: ['long'] },

                 // Type 5 (12 questions: 6 short, 6 long)
                 { id: 13, text: "J'ai un grand besoin de comprendre le fonctionnement des choses en profondeur.", type: 5, level: ['short', 'long'] },
                 { id: 14, text: "J'appr√©cie √©norm√©ment mon temps seul pour r√©fl√©chir, apprendre et recharger mes batteries.", type: 5, level: ['short', 'long'] },
                 { id: 15, text: "Je pr√©f√®re observer et analyser une situation avant de m'y impliquer.", type: 5, level: ['short', 'long'] },
                 { id: 501, text: "Je me sens plus √† l'aise avec les id√©es et les concepts qu'avec les √©motions fortes.", type: 5, level: ['short', 'long'] },
                 { id: 502, text: "Je crains d'√™tre envahi(e) ou que mes ressources (temps, √©nergie) soient √©puis√©es par les autres.", type: 5, level: ['short', 'long'] },
                 { id: 503, text: "L'autonomie et la comp√©tence intellectuelle sont tr√®s importantes pour moi.", type: 5, level: ['short', 'long'] },
                 { id: 504, text: "Je peux para√Ætre d√©tach√©(e) ou distant(e) sans m'en rendre compte.", type: 5, level: ['long'] },
                 { id: 505, text: "J'accumule des connaissances ou des ressources pour me sentir pr√©par√©(e) et en s√©curit√©.", type: 5, level: ['long'] },
                 { id: 506, text: "Les interactions sociales prolong√©es peuvent me fatiguer consid√©rablement.", type: 5, level: ['long'] },
                 { id: 507, text: "J'ai tendance √† minimiser mes propres besoins physiques ou √©motionnels.", type: 5, level: ['long'] },
                 { id: 508, text: "Sous pression, je peux me retirer encore plus ou me perdre dans mes pens√©es.", type: 5, level: ['long'] },
                 { id: 509, text: "Partager mes pens√©es ou sentiments intimes ne vient pas naturellement.", type: 5, level: ['long'] },

                 // Type 6 (12 questions: 6 short, 6 long)
                 { id: 16, text: "La s√©curit√©, la stabilit√© et la pr√©visibilit√© sont tr√®s importantes pour moi.", type: 6, level: ['short', 'long'] },
                 { id: 17, text: "J'ai tendance √† imaginer les pires sc√©narios possibles pour m'y pr√©parer.", type: 6, level: ['short', 'long'] },
                 { id: 18, text: "La loyaut√© envers mes proches, mes id√©es ou mes groupes est fondamentale.", type: 6, level: ['short', 'long'] },
                 { id: 601, text: "Je doute souvent de moi-m√™me et je cherche des confirmations ou des avis ext√©rieurs.", type: 6, level: ['short', 'long'] },
                 { id: 602, text: "Je suis tr√®s sensible aux dangers potentiels et aux intentions cach√©es.", type: 6, level: ['short', 'long'] },
                 { id: 603, text: "J'ai besoin de savoir √† quoi m'attendre et de comprendre les r√®gles.", type: 6, level: ['short', 'long'] },
                 { id: 604, text: "Je peux √™tre m√©fiant(e) envers l'autorit√© mais aussi chercher une autorit√© fiable √† suivre.", type: 6, level: ['long'] },
                 { id: 605, text: "L'anxi√©t√© est une √©motion que je connais bien.", type: 6, level: ['long'] },
                 { id: 606, text: "Je peux √™tre tr√®s courageux(se) et d√©vou√©(e) pour d√©fendre les causes ou les personnes auxquelles je crois.", type: 6, level: ['long'] },
                 { id: 607, text: "Prendre des d√©cisions importantes peut √™tre un processus long et angoissant.", type: 6, level: ['long'] },
                 { id: 608, text: "Sous stress, je peux devenir plus r√©actif(ve), accusateur(trice) ou excessivement prudent(e).", type: 6, level: ['long'] },
                 { id: 609, text: "Je cherche des alli√©s et des syst√®mes de soutien fiables.", type: 6, level: ['long'] },

                 // Type 7 (12 questions: 6 short, 6 long)
                 { id: 19, text: "J'aime explorer de nouvelles possibilit√©s, exp√©riences et id√©es.", type: 7, level: ['short', 'long'] },
                 { id: 20, text: "Je cherche √† maintenir un √©tat d'esprit positif et j'√©vite les sentiments d√©sagr√©ables.", type: 7, level: ['short', 'long'] },
                 { id: 21, text: "Je suis g√©n√©ralement optimiste, √©nergique et enthousiaste.", type: 7, level: ['short', 'long'] },
                 { id: 701, text: "J'ai souvent plusieurs projets ou int√©r√™ts en m√™me temps.", type: 7, level: ['short', 'long'] },
                 { id: 702, text: "La routine et les limitations m'ennuient rapidement.", type: 7, level: ['short', 'long'] },
                 { id: 703, text: "Je suis dou√©(e) pour voir le bon c√¥t√© des choses et trouver des solutions cr√©atives.", type: 7, level: ['short', 'long'] },
                 { id: 704, text: "J'ai peur de manquer quelque chose d'excitant ou d'important (FOMO).", type: 7, level: ['long'] },
                 { id: 705, text: "L'engagement √† long terme peut me sembler effrayant ou restrictif.", type: 7, level: ['long'] },
                 { id: 706, text: "Je peux avoir tendance √† rationaliser ou √† minimiser les probl√®mes.", type: 7, level: ['long'] },
                 { id: 707, text: "J'ai du mal √† rester concentr√©(e) sur une t√¢che si elle devient ennuyeuse ou difficile.", type: 7, level: ['long'] },
                 { id: 708, text: "Sous pression, je peux devenir dispers√©(e), irritable ou excessivement critique.", type: 7, level: ['long'] },
                 { id: 709, text: "Planifier l'avenir et anticiper des exp√©riences agr√©ables me motive.", type: 7, level: ['long'] },

                 // Type 8 (12 questions: 6 short, 6 long)
                 { id: 22, text: "Je n'h√©site pas √† prendre les choses en main et √† diriger.", type: 8, level: ['short', 'long'] },
                 { id: 23, text: "Je prot√®ge farouchement les personnes et les causes qui me tiennent √† c≈ìur.", type: 8, level: ['short', 'long'] },
                 { id: 24, text: "J'aime avoir le contr√¥le de mon environnement et de ma destin√©e.", type: 8, level: ['short', 'long'] },
                 { id: 801, text: "Je suis direct(e), assertif(ve) et je n'ai pas peur de la confrontation.", type: 8, level: ['short', 'long'] },
                 { id: 802, text: "L'injustice et la faiblesse (surtout quand elle est exploit√©e) me r√©voltent.", type: 8, level: ['short', 'long'] },
                 { id: 803, text: "J'ai une grande √©nergie et une forte pr√©sence qui se remarque.", type: 8, level: ['short', 'long'] },
                 { id: 804, text: "Je d√©teste me sentir contr√¥l√©(e), faible ou vuln√©rable.", type: 8, level: ['long'] },
                 { id: 805, text: "Je peux parfois para√Ætre intimidant(e) ou dominateur(trice) sans le vouloir.", type: 8, level: ['long'] },
                 { id: 806, text: "Montrer ma vuln√©rabilit√© est quelque chose de tr√®s difficile pour moi.", type: 8, level: ['long'] },
                 { id: 807, text: "Je respecte la force et l'honn√™tet√© brute chez les autres.", type: 8, level: ['long'] },
                 { id: 808, text: "Sous stress, je peux devenir encore plus combatif(ve) ou au contraire me retirer.", type: 8, level: ['long'] },
                 { id: 809, text: "J'agis souvent de mani√®re d√©cisive, en me fiant √† mon instinct.", type: 8, level: ['long'] },

                 // Type 9 (12 questions: 6 short, 6 long)
                 { id: 25, text: "Maintenir la paix et l'harmonie autour de moi est une priorit√© absolue.", type: 9, level: ['short', 'long'] },
                 { id: 26, text: "J'ai tendance √† √©viter les conflits et les tensions autant que possible.", type: 9, level: ['short', 'long'] },
                 { id: 27, text: "Je peux facilement voir et comprendre les diff√©rents points de vue dans une situation.", type: 9, level: ['short', 'long'] },
                 { id: 901, text: "J'ai parfois du mal √† savoir ce que je veux vraiment ou √† prendre position.", type: 9, level: ['short', 'long'] },
                 { id: 902, text: "Je suis g√©n√©ralement calme, facile √† vivre et accommodant(e).", type: 9, level: ['short', 'long'] },
                 { id: 903, text: "Je peux 'fusionner' avec les d√©sirs ou les opinions des autres pour maintenir l'harmonie.", type: 9, level: ['short', 'long'] },
                 { id: 904, text: "La col√®re est une √©motion difficile √† reconna√Ætre ou √† exprimer directement.", type: 9, level: ['long'] },
                 { id: 905, text: "Je peux procrastiner sur des t√¢ches importantes, surtout si elles risquent de cr√©er des tensions.", type: 9, level: ['long'] },
                 { id: 906, text: "Je peux me 'd√©connecter' ou minimiser les probl√®mes pour pr√©server ma tranquillit√©.", type: 9, level: ['long'] },
                 { id: 907, text: "Je peux √™tre √©tonnamment t√™tu(e) et r√©sistant(e) au changement si je me sens pouss√©(e).", type: 9, level: ['long'] },
                 { id: 908, text: "Sous stress, je peux devenir plus anxieux(se) ou compl√®tement passif(ve).", type: 9, level: ['long'] },
                 { id: 909, text: "J'appr√©cie les routines confortables et un environnement paisible.", type: 9, level: ['long'] },
            ];

            // ---=== APPLICATION STATE ===---
            let currentView = 'home';
            let currentQuestionIndex = 0;
            const questionsPerPage = 5; // Nombre de questions par page
            let userAnswers = {}; // Stocke les r√©ponses { questionId: answerValue }
            let scores = {}; // Stocke les scores calcul√©s { typeNumber: scoreValue }
            let userResult = null; // Stocke l'objet r√©sultat final { mainType, wings, scores, tiedTypes, testLevel }
            let activeQuestions = []; // Questions filtr√©es pour le test en cours
            let currentTestLevel = null; // 'short' ou 'long'

            // ---=== DOM ELEMENTS ===---
            const views = document.querySelectorAll('.view');
            const homeView = document.getElementById('home');
            const startShortTestBtn = document.getElementById('start-short-test-btn');
            const startLongTestBtn = document.getElementById('start-long-test-btn');
            const viewTypesHomeBtn = document.getElementById('view-types-home-btn');
            const viewComparisonBtn = document.getElementById('view-comparison-btn');
            // AJOUT: √âl√©ments pour la reprise de test
            const resumeTestInfo = document.getElementById('resume-test-info');
            const resumeTestLevelSpan = document.getElementById('resume-test-level-info');
            const resumePageSpan = document.getElementById('resume-page-info');
            const resumeTestBtn = document.getElementById('resume-test-btn');
            const abandonTestBtn = document.getElementById('abandon-test-btn');
            // MODIFICATION: √âl√©ment pour le r√©sultat sauvegard√©
            const savedResultInfo = document.getElementById('saved-result-info');
            const showSavedResultBtn = document.getElementById('show-saved-result-btn');
            const clearSavedResultBtn = document.getElementById('clear-saved-result-btn');
            const testView = document.getElementById('test');
            const testTitle = document.getElementById('test-title');
            const questionContainer = document.getElementById('question-container');
            const progressBar = document.getElementById('test-progress');
            // MODIFICATION: Spans pour la num√©rotation des questions
            const currentQNumberSpan = document.getElementById('current-q-number');
            const endQNumberSpan = document.getElementById('end-q-number');
            const totalQNumberSpan = document.getElementById('total-q-number');
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            const finishBtn = document.getElementById('finish-btn');
            const saveAndReturnBtn = document.getElementById('save-and-return-btn');
            const resultsView = document.getElementById('results');
            const resultsTestLevelSpan = document.getElementById('results-test-level');
            const resultsSummaryH2 = resultsView.querySelector('#results-summary h2');
            const wingsInfoP = document.getElementById('wings-info');
            const resultsChartDiv = document.getElementById('results-chart');
            const viewMyTypeDetailsBtn = document.getElementById('view-my-type-details-btn');
            const exploreOtherTypesBtn = document.getElementById('explore-other-types-btn');
            const redoTestBtn = document.getElementById('redo-test-btn');
            const typesView = document.getElementById('types');
            const typeSelectionDiv = document.getElementById('type-selection');
            const typeDetailContentDiv = document.getElementById('type-detail-content');
            const typesBackBtn = document.getElementById('types-back-btn');
            const comparisonView = document.getElementById('comparison');
            const compareType1Select = document.getElementById('compare-type1');
            const compareType2Select = document.getElementById('compare-type2');
            const compareBtn = document.getElementById('compare-btn');
            const comparisonResultDiv = document.getElementById('comparison-result');
            const comparisonBackBtn = document.getElementById('comparison-back-btn');

            // ---=== CONSTANTES LOCALSTORAGE ===---
            const LS_TEST_STATE_KEY = 'enneagramTestState'; // Pour le test en cours
            const LS_RESULT_KEY = 'enneagramResult';       // Pour le r√©sultat final

            // ---=== FUNCTIONS ===---
            function showView(viewId) {
                const targetView = document.getElementById(viewId);
                if (!targetView) return;
                views.forEach(view => view.classList.remove('active'));
                targetView.classList.add('active');
                currentView = viewId;
                window.scrollTo(0, 0);
                if (viewId !== 'types') hideTypeDetails(false); // Ne masque les d√©tails que si on quitte la vue 'types'
            }

            function goBackToPreviousRelevantView() {
                // Si on est dans la vue types, retourne aux r√©sultats si existants, sinon home
                if (currentView === 'types') {
                    if (userResult && userResult.mainType) { // V√©rifie si un r√©sultat est charg√©
                         showView('results');
                    } else {
                        showView('home');
                    }
                // Si on est dans la vue comparison, retourne √† l'accueil
                } else if (currentView === 'comparison') {
                     showView('home');
                // TODO: Ajouter d'autres logiques de retour si n√©cessaire pour d'autres vues
                } else {
                    showView('home'); // Comportement par d√©faut
                }
            }

            // AJOUT: Sauvegarde l'√©tat actuel du test (r√©ponses, index, niveau)
            function saveTestState() {
                if (currentTestLevel && activeQuestions.length > 0) {
                    const state = {
                        answers: userAnswers,
                        index: currentQuestionIndex,
                        level: currentTestLevel
                    };
                    try {
                        localStorage.setItem(LS_TEST_STATE_KEY, JSON.stringify(state));
                        console.log("Test state saved:", state);
                    } catch (e) {
                        console.error("Failed to save test state to localStorage:", e);
                    }
                }
            }

            // AJOUT: Charge l'√©tat du test sauvegard√©
            function loadTestState() {
                try {
                    const savedState = localStorage.getItem(LS_TEST_STATE_KEY);
                    if (savedState) {
                        return JSON.parse(savedState);
                    }
                } catch (e) {
                    console.error("Failed to load or parse test state from localStorage:", e);
                    localStorage.removeItem(LS_TEST_STATE_KEY); // Clear corrupted state
                }
                return null;
            }

            // AJOUT: Supprime l'√©tat du test sauvegard√©
            function clearTestState() {
                localStorage.removeItem(LS_TEST_STATE_KEY);
                console.log("Test state cleared.");
            }

            // AJOUT: Fonction pour reprendre un test
            function resumeTest(savedState) {
                if (!savedState || !savedState.level || savedState.index === undefined || !savedState.answers) {
                    console.error("Invalid saved state for resume.");
                    clearTestState();
                    hideResumeTestInfo();
                    return;
                }
                console.log("Resuming test with state:", savedState);
                currentTestLevel = savedState.level;
                currentQuestionIndex = savedState.index;
                userAnswers = savedState.answers || {}; // Assurer que userAnswers est un objet
                activeQuestions = allQuestions.filter(q => q.level.includes(currentTestLevel));

                if (activeQuestions.length === 0) {
                    console.error("Could not filter questions for saved level:", currentTestLevel);
                    resetTestAndShowHome(); // Fallback to reset
                    return;
                }

                totalQNumberSpan.textContent = activeQuestions.length;
                testTitle.textContent = `Questionnaire Enn√©agramme (${currentTestLevel === 'short' ? 'Rapide' : 'Complet'}) - Reprise`;
                displayCurrentQuestions(); // Affiche la page sauvegard√©e
                updateProgress();
                showView('test');
                hideResumeTestInfo(); // Masque la proposition de reprise une fois le test repris
            }

            // AJOUT: Fonctions pour afficher/masquer la proposition de reprise
            function showResumeTestInfo(state) {
                 if (resumeTestInfo && state) {
                    resumeTestLevelSpan.textContent = state.level === 'short' ? 'Rapide' : 'Complet';
                    const currentPage = Math.floor(state.index / questionsPerPage) + 1;
                    const totalPages = Math.ceil(activeQuestions.length / questionsPerPage) || 1; // Avoid division by zero
                    resumePageSpan.textContent = `${currentPage} / ${totalPages}`;
                    resumeTestInfo.style.display = 'block';
                 }
            }

            function hideResumeTestInfo() {
                if (resumeTestInfo) resumeTestInfo.style.display = 'none';
            }


            function startTest(testLevel) {
                // MODIFICATION: Efface l'√©tat pr√©c√©dent avant de d√©marrer
                clearTestState();
                hideResumeTestInfo(); // S'assurer que la proposition de reprise est masqu√©e

                currentTestLevel = testLevel;
                activeQuestions = allQuestions.filter(q => q.level.includes(testLevel));
                console.log(`Starting test: ${testLevel}, Questions: ${activeQuestions.length}`);
                currentQuestionIndex = 0;
                userAnswers = {}; // R√©initialise les r√©ponses pour un nouveau test
                scores = {};
                userResult = null; // R√©initialise le r√©sultat pr√©c√©dent
                localStorage.removeItem(LS_RESULT_KEY); // Efface l'ancien r√©sultat final s'il existe
                if (savedResultInfo) savedResultInfo.style.display = 'none'; // Masque l'info de r√©sultat sauvegard√©

                if (activeQuestions.length === 0) {
                     console.error("No questions found for level:", testLevel);
                     alert("Erreur : Aucune question trouv√©e pour ce niveau de test.");
                     return;
                 }

                totalQNumberSpan.textContent = activeQuestions.length;
                testTitle.textContent = `Questionnaire Enn√©agramme (${testLevel === 'short' ? 'Rapide' : 'Complet'})`;
                displayCurrentQuestions();
                updateProgress();
                showView('test');
                // MODIFICATION: Ne sauvegarde pas l'√©tat initial ici, seulement apr√®s une action utilisateur (next/prev/save&return)
            }

            function displayCurrentQuestions() {
                questionContainer.innerHTML = '';
                const start = currentQuestionIndex;
                const end = Math.min(start + questionsPerPage, activeQuestions.length);

                // MODIFICATION: Mise √† jour des num√©ros de question affich√©s
                currentQNumberSpan.textContent = start + 1;
                endQNumberSpan.textContent = end;

                if (activeQuestions.length === 0) {
                     console.error("displayCurrentQuestions called with no active questions.");
                     questionContainer.innerHTML = "<p>Erreur : Impossible de charger les questions.</p>";
                     // D√©sactiver la navigation si aucune question
                     prevBtn.disabled = true;
                     nextBtn.disabled = true;
                     finishBtn.style.display = 'none';
                     saveAndReturnBtn.disabled = true;
                     return;
                }

                for (let i = start; i < end; i++) {
                    // V√©rifie si l'index est valide
                    if (i >= activeQuestions.length || i < 0) {
                        console.error(`Invalid question index requested: ${i}`);
                        continue; // Passe √† l'it√©ration suivante
                    }
                    const q = activeQuestions[i];
                     if (!q) {
                        console.error(`Question object is undefined at index: ${i}`);
                        continue; // Passe √† l'it√©ration suivante
                    }

                    const questionDiv = document.createElement('div');
                    questionDiv.classList.add('question-item');
                    // Utilisation de template literals pour une meilleure lisibilit√©
                    questionDiv.innerHTML = `
                        <p>${i + 1}. ${q.text}</p>
                        <div class="likert-scale" data-question-id="${q.id}">
                            <label><input type="radio" name="q${q.id}" value="1"><span>Pas du tout<br>d'accord</span></label>
                            <label><input type="radio" name="q${q.id}" value="2"><span>Plut√¥t pas<br>d'accord</span></label>
                            <label><input type="radio" name="q${q.id}" value="3"><span>Neutre</span></label>
                            <label><input type="radio" name="q${q.id}" value="4"><span>Plut√¥t<br>d'accord</span></label>
                            <label><input type="radio" name="q${q.id}" value="5"><span>Tout √† fait<br>d'accord</span></label>
                        </div>`;
                    questionContainer.appendChild(questionDiv);

                    // Pr√©-cocher la r√©ponse si elle existe dans userAnswers
                    if (userAnswers[q.id]) {
                        const savedInput = questionDiv.querySelector(`input[name="q${q.id}"][value="${userAnswers[q.id]}"]`);
                        if (savedInput) {
                            savedInput.checked = true;
                        } else {
                            console.warn(`Could not find radio button for saved answer q${q.id} value ${userAnswers[q.id]}`);
                        }
                    }
                }

                // Rattacher l'√©couteur d'√©v√©nements (bonne pratique de le d√©tacher avant si d√©j√† attach√©)
                questionContainer.removeEventListener('change', handleAnswerChange); // Pr√©caution
                questionContainer.addEventListener('change', handleAnswerChange);

                updateNavigationButtons();
                // Ne pas sauvegarder l'√©tat ici automatiquement, attendre une action utilisateur
            }

            function handleAnswerChange(event) {
                if (event.target.type === 'radio' && event.target.name.startsWith('q')) {
                    // Utiliser event.target.closest pour trouver l'ID de la question parente
                    const scaleDiv = event.target.closest('.likert-scale');
                    if(scaleDiv && scaleDiv.dataset.questionId) {
                        const questionId = parseInt(scaleDiv.dataset.questionId);
                        const answerValue = parseInt(event.target.value);
                        if (!isNaN(questionId) && !isNaN(answerValue)) {
                            userAnswers[questionId] = answerValue;
                            // Optionnel: Sauvegarder imm√©diatement apr√®s chaque r√©ponse ?
                            // saveTestState(); // D√©commenter si vous voulez sauvegarder apr√®s chaque clic
                            console.log(`Answered Q${questionId}: ${answerValue}`);
                        } else {
                             console.error("Invalid questionId or answerValue in handleAnswerChange");
                        }
                    } else {
                         console.error("Could not find question ID for the changed radio button.");
                    }
                }
            }


            // MODIFICATION: Renomm√©e pour plus de clart√©, valide si toutes les questions de la page actuelle sont r√©pondues
            function validateCurrentPageAnswers() {
                let allAnswered = true;
                const start = currentQuestionIndex;
                const end = Math.min(start + questionsPerPage, activeQuestions.length);
                for (let i = start; i < end; i++) {
                    const questionId = activeQuestions[i]?.id;
                     if (!questionId || userAnswers[questionId] === undefined || userAnswers[questionId] === null) {
                         allAnswered = false;
                         console.warn(`Question ${questionId || i+1} on current page not answered.`);
                         break; // Pas besoin de v√©rifier les autres
                     }
                 }
                 return allAnswered;
            }

            function nextQuestions() {
                // Valide les r√©ponses de la page actuelle AVANT de naviguer
                if (!validateCurrentPageAnswers()) {
                    alert("Veuillez r√©pondre √† toutes les questions sur cette page avant de continuer.");
                    return; // Bloque la navigation
                }

                // V√©rifie si on n'est pas d√©j√† √† la fin
                 if (currentQuestionIndex + questionsPerPage < activeQuestions.length) {
                    currentQuestionIndex += questionsPerPage;
                    displayCurrentQuestions();
                    updateProgress();
                    saveTestState(); // MODIFICATION: Sauvegarde l'√©tat apr√®s avoir chang√© de page
                } else {
                    // Si on est sur la derni√®re page et qu'on clique suivant (ce qui ne devrait pas arriver car le bouton est cach√©), on ne fait rien ou on d√©clenche la fin
                    console.warn("Next clicked on the last page or beyond.");
                    // Optionnellement, d√©clencher la fin si toutes les r√©ponses sont l√†
                    // calculateResults();
                }
            }

            function previousQuestions() {
                 // Il n'est g√©n√©ralement pas n√©cessaire de valider en arri√®re, mais on peut le faire si besoin.
                 // saveCurrentPageAnswers(); // Enregistre les r√©ponses de la page actuelle avant de revenir en arri√®re

                if (currentQuestionIndex > 0) {
                    currentQuestionIndex -= questionsPerPage;
                    if (currentQuestionIndex < 0) currentQuestionIndex = 0; // S√©curit√©
                    displayCurrentQuestions();
                    updateProgress();
                    saveTestState(); // MODIFICATION: Sauvegarde l'√©tat apr√®s avoir chang√© de page
                 }
            }

            function updateNavigationButtons() {
                prevBtn.disabled = currentQuestionIndex === 0;

                // Est-ce la derni√®re page ?
                const isLastPage = (currentQuestionIndex + questionsPerPage) >= activeQuestions.length;

                // Affiche/Masque les boutons Suivant/Terminer
                nextBtn.style.display = isLastPage ? 'none' : 'inline-block';
                finishBtn.style.display = isLastPage ? 'inline-block' : 'none';

                // D√©sactive Terminer si les r√©ponses de la derni√®re page ne sont pas valides (s√©curit√©)
                // Note: La validation se fera aussi au clic sur Terminer dans calculateResults
                // finishBtn.disabled = isLastPage && !validateCurrentPageAnswers(); // Optionnel: validation en temps r√©el du bouton
            }

            function updateProgress() {
                // Utilise l'index de la *premi√®re* question de la page actuelle pour calculer le progr√®s
                 const questionsCompleted = currentQuestionIndex; // Questions des pages pr√©c√©dentes
                 const totalQuestions = activeQuestions.length;
                 // Barre de progression bas√©e sur le d√©but de la page actuelle
                 const progressPercentage = totalQuestions > 0 ? (questionsCompleted / totalQuestions) * 100 : 0;
                 // Pour une progression plus "granulaire" (par question r√©pondue):
                 // const answeredCount = Object.keys(userAnswers).filter(id => activeQuestions.some(q => q.id == id)).length;
                 // const progressPercentage = totalQuestions > 0 ? (answeredCount / totalQuestions) * 100 : 0;

                 progressBar.style.width = `${Math.min(100, progressPercentage)}%`;
            }

            function calculateResults() {
                 // MODIFICATION: Valide que les r√©ponses de la DERNI√àRE page sont donn√©es
                 if (!validateCurrentPageAnswers()) {
                    alert("Veuillez r√©pondre √† toutes les questions de la derni√®re page avant de voir les r√©sultats.");
                    return;
                 }

                 // Le reste de la logique de calcul est inchang√©...
                scores = { 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0, 7: 0, 8: 0, 9: 0 };
                let answeredQuestionsCount = 0;
                // S'assurer qu'on boucle sur les questions ACTIVES pour ce test
                for (const q of activeQuestions) {
                    // V√©rifier si une r√©ponse existe pour cette question active
                     const answer = userAnswers[q.id];
                     if (answer !== undefined && answer !== null) {
                         scores[q.type] += answer; // Utilise la valeur num√©rique directement
                         answeredQuestionsCount++;
                    } else {
                        console.warn(`Question active ID ${q.id} (Type ${q.type}) non r√©pondue ou r√©ponse invalide.`);
                        // Ne pas ajouter au score si non r√©pondu
                    }
                }

                 // V√©rifier si suffisamment de questions ont √©t√© r√©pondues
                 if (activeQuestions.length > 0 && answeredQuestionsCount < activeQuestions.length * 0.8) {
                     alert("Pas assez de r√©ponses pour calculer un r√©sultat fiable. Veuillez r√©pondre √† davantage de questions.");
                     console.warn(`Calculation aborted: Only ${answeredQuestionsCount}/${activeQuestions.length} questions answered.`);
                     return; // Ne pas continuer si pas assez de r√©ponses
                 } else if (activeQuestions.length === 0) {
                     alert("Erreur: Impossible de calculer les r√©sultats car aucune question n'√©tait active.");
                     return;
                 }


                 // Calcul du type principal et des √©galit√©s
                let mainType = -1, maxScore = -1, tiedTypes = [];
                for (const type in scores) {
                    if (scores.hasOwnProperty(type)) {
                        const score = scores[type];
                         if (score > maxScore) {
                             maxScore = score;
                             mainType = parseInt(type);
                             tiedTypes = [mainType]; // R√©initialise les √©galit√©s
                        } else if (score === maxScore) {
                             tiedTypes.push(parseInt(type)); // Ajoute √† la liste des √©galit√©s
                         }
                    }
                 }

                 // Calcul des ailes
                let wings = [];
                if (mainType !== -1) {
                     const w1Type = mainType === 1 ? 9 : mainType - 1;
                     const w2Type = mainType === 9 ? 1 : mainType + 1;
                     const w1Score = scores[w1Type] || 0;
                     const w2Score = scores[w2Type] || 0;

                     // Seuil plus flexible pour identifier une aile potentielle (ex: > 65% du score max)
                     // Et l'aile doit avoir un score significativement plus haut que l'autre aile potentielle OU √™tre tr√®s proche
                     const threshold = maxScore * 0.65; // Ajustable
                     const differenceThreshold = Math.max(2, maxScore * 0.1); // Diff√©rence minimale pour d√©partager, au moins 2 points ou 10%

                     if (w1Score >= threshold && w2Score >= threshold) { // Les deux sont au dessus du seuil
                         if (Math.abs(w1Score - w2Score) < differenceThreshold) { // Scores tr√®s proches, les deux ailes sont possibles
                             wings.push(w1Type);
                             wings.push(w2Type);
                         } else if (w1Score > w2Score) { // Aile 1 significativement plus forte
                             wings.push(w1Type);
                         } else { // Aile 2 significativement plus forte
                             wings.push(w2Type);
                         }
                     } else if (w1Score >= threshold) { // Seule Aile 1 est au dessus du seuil
                         wings.push(w1Type);
                     } else if (w2Score >= threshold) { // Seule Aile 2 est au dessus du seuil
                         wings.push(w2Type);
                     }
                     // Si aucune n'atteint le seuil, wings reste vide []
                }

                userResult = { mainType, wings, scores, tiedTypes, testLevel: currentTestLevel };

                saveFinalResultToLocalStorage(); // Sauvegarde le r√©sultat final
                clearTestState(); // MODIFICATION: Efface l'√©tat du test en cours puisqu'il est termin√©

                displayResults();
            }

            // MODIFICATION: Fonction d√©di√©e pour sauvegarder le r√©sultat final
            function saveFinalResultToLocalStorage() {
                console.log("Saving final result to localStorage...");
                if (userResult) {
                    try {
                        localStorage.setItem(LS_RESULT_KEY, JSON.stringify(userResult));
                        console.log("Final result saved successfully:", userResult);
                    } catch (e) {
                        console.error("Failed to save final result to localStorage:", e);
                    }
                } else {
                    console.warn("Attempted to save final result, but userResult is null.");
                }
            }

            // MODIFICATION: Fonction d√©di√©e pour charger le r√©sultat final
            function loadFinalResultFromLocalStorage() {
                try {
                    const saved = localStorage.getItem(LS_RESULT_KEY);
                    console.log("Loaded final result from localStorage:", saved);
                    if (saved) {
                        const parsedResult = JSON.parse(saved);
                        // Validation simple de la structure
                        if (parsedResult && typeof parsedResult.scores === 'object' && parsedResult.mainType !== undefined) {
                            userResult = parsedResult; // Met √† jour l'√©tat global userResult
                            console.log("Parsed final result:", userResult);
                            return true; // Succ√®s
                        } else {
                            console.warn("Loaded final result data is invalid or incomplete.");
                            localStorage.removeItem(LS_RESULT_KEY); // Supprime les donn√©es invalides
                        }
                    }
                } catch (e) {
                    console.error("Failed to load or parse final result from localStorage:", e);
                    localStorage.removeItem(LS_RESULT_KEY); // Supprime les donn√©es corrompues
                }
                userResult = null; // Assure que userResult est null si le chargement √©choue
                return false; // √âchec
            }

            function displayResults() {
                // Assure que userResult contient bien les donn√©es du r√©sultat final
                if (!userResult || !userResult.scores) {
                    console.error("displayResults called but no valid userResult data available.");
                    // Optionnel: Rediriger vers l'accueil ou afficher un message d'erreur
                     showView('home');
                     alert("Impossible d'afficher les r√©sultats. Aucune donn√©e valide trouv√©e.");
                    return;
                }

                 const { mainType, wings, scores, tiedTypes, testLevel } = userResult;

                 // Affichage du niveau de test
                 resultsTestLevelSpan.textContent = testLevel === 'short' ? 'rapide' : 'complet';

                 // Affichage du type principal et des √©galit√©s
                 if (mainType !== -1 && enneagramData[mainType]) {
                     let typeName = enneagramData[mainType].name;
                     let typeNumber = mainType;
                     let tiedMessage = '';
                     if (tiedTypes && tiedTypes.length > 1) {
                         const otherTiedTypes = tiedTypes.filter(t => t !== mainType).join(', ');
                         if (otherTiedTypes) {
                             tiedMessage = ` <small style="color:var(--text-muted-color); font-weight:normal;">(√âgalit√© possible avec Type(s) ${otherTiedTypes})</small>`;
                         }
                     }
                     resultsSummaryH2.innerHTML = `Type principal : <span class="type-text-${mainType}" style="font-weight: 700;">${typeName}</span> (${typeNumber})${tiedMessage}`;

                     // Affichage des ailes
                     let wingsText = "Aile(s) potentielle(s) : ";
                     if (wings && wings.length > 0) {
                         wingsText += wings.map(w => `${w} (${enneagramData[w] ? enneagramData[w].name : 'Type '+w})`).join(' et ');
                     } else {
                         // Si aucune aile n'est clairement marqu√©e, sugg√©rer de consid√©rer les voisins
                         const w1 = mainType === 1 ? 9 : mainType - 1;
                         const w2 = mainType === 9 ? 1 : mainType + 1;
                         wingsText = `Aucune aile clairement dominante. Consid√©rez les influences possibles des types ${w1} et ${w2}.`;
                     }
                     wingsInfoP.textContent = wingsText;

                     // Active le bouton "D√©tails de mon type"
                     viewMyTypeDetailsBtn.onclick = () => displayTypeDetails(mainType);
                     viewMyTypeDetailsBtn.disabled = false;

                 } else {
                     // Cas o√π aucun type principal n'est d√©termin√©
                     resultsSummaryH2.innerHTML = `Type principal : <span id="main-type-name">Ind√©termin√©</span> (<span id="main-type-number">?</span>)`;
                     wingsInfoP.textContent = "Le score maximum est trop bas ou partag√© entre trop de types. Essayez le test complet ou r√©pondez plus attentivement.";
                     viewMyTypeDetailsBtn.disabled = true;
                     viewMyTypeDetailsBtn.onclick = null;
                 }

                 // G√©n√©ration du graphique
                 resultsChartDiv.innerHTML = ''; // Vide le graphique pr√©c√©dent
                 let maxScoreValue = 0;
                 // Trouve le score maximum parmi tous les types pour normaliser le graphique
                 for (const type in scores) {
                     const numScore = Number(scores[type] || 0);
                     if (!isNaN(numScore) && numScore > maxScoreValue) {
                         maxScoreValue = numScore;
                     }
                 }
                 // √âvite la division par z√©ro si tous les scores sont √† 0 ou n√©gatifs
                 if (maxScoreValue <= 0) maxScoreValue = 1;

                 for (let i = 1; i <= 9; i++) {
                     const score = scores[i] || 0;
                     const numScore = Number(score);
                     // V√©rifie si le score est un nombre valide avant de l'utiliser
                     if (isNaN(numScore)) {
                         console.warn(`Score for type ${i} is not a number: ${scores[i]}`);
                         continue; // Ignore ce type s'il a un score invalide
                     }

                     const barHeight = Math.max(0, Math.min(100, (numScore / maxScoreValue) * 100)); // Calcule la hauteur en pourcentage
                     const barContainer = document.createElement('div');
                     barContainer.className = 'chart-bar-container';

                     const bar = document.createElement('div');
                     bar.className = `chart-bar type-bg-${i}`;
                     bar.style.height = `0%`; // Commence √† 0 pour l'animation
                     bar.dataset.score = numScore; // Stocke le score brut pour l'infobulle

                     const label = document.createElement('div');
                     label.className = 'chart-label';
                     label.textContent = i; // Num√©ro du type

                     barContainer.append(bar, label);
                     resultsChartDiv.appendChild(barContainer);

                     // D√©clenche l'animation de la barre apr√®s un court d√©lai
                     // pour s'assurer qu'elle est ajout√©e au DOM
                     setTimeout(() => {
                          bar.style.height = `${barHeight}%`;
                     }, 50); // Petit d√©lai pour l'effet d'animation
                 }

                 // Affiche la vue des r√©sultats
                 showView('results');
            }

            function resetTestAndShowHome() {
                 // R√©initialise toutes les variables d'√©tat du test
                 userResult = null;
                 userAnswers = {};
                 scores = {};
                 activeQuestions = [];
                 currentTestLevel = null;
                 currentQuestionIndex = 0;

                 // Efface les donn√©es sauvegard√©es (r√©sultat final ET √©tat en cours)
                 localStorage.removeItem(LS_RESULT_KEY);
                 clearTestState(); // Utilise la fonction d√©di√©e

                 // Masque les sections d'info sur la page d'accueil
                 if (savedResultInfo) savedResultInfo.style.display = 'none';
                 hideResumeTestInfo();

                 // Retourne √† l'accueil
                 showView('home');
                 console.log("Test reset and returned to home.");
            }

            // --- Fonctions pour Types et Comparaison (inchang√©es ou mineures) ---
             function populateTypeSelection() {
                 typeSelectionDiv.innerHTML = '';
                 for (let i = 1; i <= 9; i++) {
                     const type = enneagramData[i];
                     if (!type) continue; // S√©curit√©
                     const button = document.createElement('button');
                     button.innerHTML = `${type.icon || i}`;
                     button.title = type.name;
                     button.onclick = () => displayTypeDetails(i);
                     button.className = `type-button outline type-color-${i}`;
                     typeSelectionDiv.appendChild(button);
                 }
                 hideTypeDetails(false); // Assure que les d√©tails sont masqu√©s initialement
            }

            function clearSelectedTypeButton() {
                typeSelectionDiv.querySelectorAll('.type-button.selected').forEach(btn => btn.classList.remove('selected'));
            }

            function displayTypeDetails(typeNumber) {
                const type = enneagramData[typeNumber];
                if (!type) return; // Si le type n'existe pas dans les donn√©es

                 clearSelectedTypeButton(); // D√©s√©lectionne les autres boutons
                 const selectedBtn = typeSelectionDiv.querySelector(`.type-color-${typeNumber}`);
                 if (selectedBtn) selectedBtn.classList.add('selected'); // Met en surbrillance le bouton cliqu√©

                 // Pr√©pare les informations sur les chemins de stress/s√©curit√©
                 let stressTargetInfo = '';
                 if (type.growthPath && enneagramData[type.growthPath]) {
                     stressTargetInfo = `(${type.growthPath} ${enneagramData[type.growthPath].name})`;
                 }
                 let securityTargetInfo = '';
                 if (type.securityPath && enneagramData[type.securityPath]) {
                    securityTargetInfo = `(${type.securityPath} ${enneagramData[type.securityPath].name})`;
                 }

                 // Construit le HTML pour les d√©tails du type
                 typeDetailContentDiv.innerHTML = `
                     <h3 class="type-text-${typeNumber}">${type.icon} ${type.name} (Type ${typeNumber})</h3>
                     <div class="type-detail-section"><h4>Description</h4><p>${type.description || "Description non disponible."}</p></div>
                     <div class="type-detail-section"><h4>Forces Cl√©s</h4><p>${type.strengths || "Forces non d√©taill√©es."}</p></div>
                     <div class="type-detail-section"><h4>Points de Vigilance</h4><p>${type.weaknesses || "D√©fis non d√©taill√©s."}</p></div>
                     <div class="type-detail-section"><h4>Motivations Fondamentales & Peurs Principales</h4><p><strong>Motivation :</strong> ${type.motivation || "Non sp√©cifi√©e."}<br><strong>Peur :</strong> ${type.fear || "Non sp√©cifi√©e."}</p></div>
                     <div class="type-detail-section"><h4>Dynamiques de Stress et S√©curit√©</h4>
                        <p><strong>En Stress <span style="color: var(--danger-color)">‚ûî</span> ${stressTargetInfo}:</strong> ${type.stress || "Comportement sous stress non d√©taill√©."}</p>
                        <p><strong>En S√©curit√© <span style="color: var(--success-color)">‚ûî</span> ${securityTargetInfo}:</strong> ${type.security || "Comportement en s√©curit√© non d√©taill√©."}</p>
                    </div>
                    <div class="type-detail-section"><h4>Chemin de Croissance</h4><p>${type.growth || "Pistes de croissance non d√©taill√©es."}</p></div>
                    <div class="type-detail-section"><h4>Conseils Pratiques</h4><p>${type.tips || "Conseils non disponibles."}</p></div>
                `;

                 // Applique la classe pour la bordure color√©e et affiche la section
                 typeDetailContentDiv.className = 'type-border-' + typeNumber; // Applique la classe pour la couleur
                 typeDetailContentDiv.style.display = 'block';

                 // Scroll vers la section des d√©tails pour la visibilit√©
                 typeDetailContentDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });

                 // Si on n'est pas d√©j√† dans la vue 'types', y naviguer
                 if (currentView !== 'types') {
                     showView('types');
                 }
            }

             function hideTypeDetails(shouldScroll = true) {
                 typeDetailContentDiv.style.display = 'none'; // Masque la section
                 typeDetailContentDiv.innerHTML = ''; // Vide le contenu
                 typeDetailContentDiv.className = ''; // Retire la classe de bordure color√©e
                 clearSelectedTypeButton(); // D√©s√©lectionne tous les boutons de type

                 // Optionnel: Scroll vers le haut de la s√©lection des types si demand√©
                 if (shouldScroll && currentView === 'types' && typeSelectionDiv) {
                    typeSelectionDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });
                 }
            }


            function populateComparisonSelectors() {
                 compareType1Select.innerHTML = '<option value="">Choisir Type 1</option>';
                 compareType2Select.innerHTML = '<option value="">Choisir Type 2</option>';
                 for (let i = 1; i <= 9; i++) {
                     const type = enneagramData[i];
                     if (!type) continue; // S√©curit√©
                     const opt1 = document.createElement('option');
                     opt1.value = i;
                     opt1.textContent = `Type ${i}: ${type.name}`;
                     compareType1Select.appendChild(opt1);

                     const opt2 = document.createElement('option');
                     opt2.value = i;
                     opt2.textContent = `Type ${i}: ${type.name}`;
                     compareType2Select.appendChild(opt2);
                 }
                 comparisonResultDiv.innerHTML = ''; // Vide les r√©sultats pr√©c√©dents
            }

            function compareTypes() {
                const t1 = compareType1Select.value;
                const t2 = compareType2Select.value;

                 // V√©rifie si les deux types sont s√©lectionn√©s
                 if (!t1 || !t2) {
                     comparisonResultDiv.innerHTML = "<p style='color: var(--danger-color); text-align:center;'>Veuillez s√©lectionner deux types √† comparer.</p>";
                     return;
                 }

                 // D√©termine la cl√© pour la matrice (toujours min-max, sauf si identiques)
                 const key = t1 === t2 ? `${t1}-${t1}` : `${Math.min(t1, t2)}-${Math.max(t1, t2)}`;
                 const dynamic = relationshipMatrix[key]; // R√©cup√®re la dynamique depuis la matrice

                 // Affiche le r√©sultat
                 if (dynamic) {
                     comparisonResultDiv.innerHTML = `
                         <h4>Dynamique Type ${t1} & Type ${t2}</h4>
                         <p>${dynamic}</p>
                         <p><em>Note : Ceci est un aper√ßu simplifi√©. Les dynamiques relationnelles r√©elles sont complexes et influenc√©es par de nombreux autres facteurs (ailes, niveaux de d√©veloppement, exp√©riences personnelles, etc.).</em></p>`;
                 } else {
                     // Si la combinaison n'est pas trouv√©e (ne devrait pas arriver avec la matrice compl√®te)
                     comparisonResultDiv.innerHTML = `<p>La dynamique sp√©cifique entre le Type ${t1} et le Type ${t2} n'est pas d√©taill√©e dans notre base de donn√©es.</p>`;
                 }
            }

            // ---=== INITIALIZATION ===---
            function init() {
                console.log("Initializing Enneagram App...");

                // 1. V√©rifier s'il y a un test EN COURS
                const savedTestState = loadTestState();
                if (savedTestState) {
                    // Filtre les questions pour obtenir le nombre total (n√©cessaire pour l'affichage de la page)
                     activeQuestions = allQuestions.filter(q => q.level.includes(savedTestState.level));
                    showResumeTestInfo(savedTestState);
                    // Listener pour le bouton Reprendre
                    resumeTestBtn.onclick = () => resumeTest(savedTestState);
                    // Listener pour le bouton Abandonner
                    abandonTestBtn.onclick = () => {
                        clearTestState();
                        hideResumeTestInfo();
                        console.log("Abandoned saved test state.");
                    };
                } else {
                    hideResumeTestInfo(); // S'assurer que la zone est cach√©e s'il n'y a pas d'√©tat
                    activeQuestions = []; // R√©initialiser au cas o√π
                }

                // 2. V√©rifier s'il y a un r√©sultat FINAL sauvegard√©
                if (loadFinalResultFromLocalStorage()) {
                    // Si un r√©sultat final existe, l'afficher dans l'info box
                    if (savedResultInfo) savedResultInfo.style.display = 'block';
                    showSavedResultBtn.onclick = () => {
                        if (userResult) displayResults(); // Affiche les r√©sultats charg√©s
                        else alert("Erreur : Aucun r√©sultat final trouv√© √† afficher.");
                    };
                    clearSavedResultBtn.onclick = () => {
                        if (confirm("Voulez-vous vraiment effacer le r√©sultat sauvegard√© ?")) {
                            localStorage.removeItem(LS_RESULT_KEY);
                            userResult = null; // Efface aussi de la m√©moire
                            if (savedResultInfo) savedResultInfo.style.display = 'none';
                            console.log("Cleared saved final result.");
                        }
                    };
                } else {
                    // Pas de r√©sultat final sauvegard√©
                    if (savedResultInfo) savedResultInfo.style.display = 'none';
                }

                // --- Ajout des autres √©couteurs d'√©v√©nements ---
                startShortTestBtn.addEventListener('click', () => startTest('short'));
                startLongTestBtn.addEventListener('click', () => startTest('long'));

                viewTypesHomeBtn.addEventListener('click', () => {
                     populateTypeSelection();
                     showView('types');
                });
                viewComparisonBtn.addEventListener('click', () => {
                    populateComparisonSelectors();
                    showView('comparison');
                });

                // Navigation dans le test
                prevBtn.addEventListener('click', previousQuestions);
                nextBtn.addEventListener('click', nextQuestions);
                finishBtn.addEventListener('click', calculateResults);
                saveAndReturnBtn.addEventListener('click', () => {
                    // Valide si des questions sont affich√©es et s'il y a des r√©ponses √† sauvegarder
                     if (currentTestLevel && activeQuestions.length > 0 && Object.keys(userAnswers).length > 0) {
                        // Optionnel: valider la page actuelle avant de sauvegarder ?
                        // if (!validateCurrentPageAnswers()) {
                        //    alert("Veuillez r√©pondre aux questions de cette page avant de sauvegarder.");
                        //    return;
                        // }
                        saveTestState(); // Sauvegarde l'√©tat actuel
                        alert("Progression sauvegard√©e. Vous pourrez reprendre le test plus tard.");
                    } else {
                         // S'il n'y a rien √† sauvegarder (test non d√©marr√© ou vide)
                         // On ne sauvegarde rien et on retourne juste √† l'accueil
                         console.log("Nothing to save, returning home.");
                    }
                    showView('home'); // Retourne √† l'accueil
                    // Recharge les infos de sauvegarde au cas o√π (pour afficher la proposition de reprise)
                    init(); // Peut-√™tre un peu lourd, alternative: juste v√©rifier/afficher resumeTestInfo
                });


                // Actions depuis la page des r√©sultats
                exploreOtherTypesBtn.addEventListener('click', () => {
                     populateTypeSelection();
                     showView('types');
                });
                redoTestBtn.addEventListener('click', () => {
                     if (confirm("√ätes-vous s√ªr de vouloir refaire un test ? Votre progression et r√©sultats actuels (si non sauvegard√©s explicitement) seront perdus.")) {
                        resetTestAndShowHome();
                    }
                });

                // Boutons de retour g√©n√©raux
                typesBackBtn.addEventListener('click', goBackToPreviousRelevantView);
                comparisonBackBtn.addEventListener('click', () => showView('home')); // Toujours retour √† l'accueil depuis comparaison

                // Afficher la vue initiale (home)
                if (currentView === 'home') { // Ne le fait que si on est bien sur home pour √©viter de forcer le retour si on √©tait sur une autre vue au chargement
                   showView('home');
                }
                console.log("Initialization complete.");
            }

            init(); // Lance l'application

        }); // Fin de DOMContentLoaded
    </script>
</body>
</html>
